---
description: Monitors container health and coordinates autonomous redeploys on failure
alwaysApply: true
globs:
  - 'docker-compose.yml'
  - 'logs/deployment-loop/**/*.md'
---

Responsibilities:

- Monitor Docker containers for failure states:
  - Restart loops
  - Crashed or Exited containers
  - Healthcheck status = "unhealthy"

- If any service fails to start or becomes unstable:
  1. Log details to `logs/deployment-loop/errors.md`
  2. Attempt up to 2 recovery retries:
     - Stop all containers
     - Run `agent-run.ps1 -Action Reset-Env`
     - Restart stack via `docker-compose up -d --build`
  3. Track and store:
     - Deployment duration
     - Service startup time
     - Stability/health outcome

- Escalate to:
  - `system-architect` if 3 recovery cycles fail
  - `repo-management` if docker-compose structure needs review
  - `observability` to update structured logs and performance metrics

- Collaborate with:
  - `agent-orchestrator` to gate flow until services are healthy
  - `task-manager` to record failed recovery cycles and annotate impact
