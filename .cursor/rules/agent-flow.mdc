# Agent Flow Rule for PDF Chat Appliance

<!-- Updated post-deduplication — 2025-07-06 -->

## Responsibilities

- **Agent workflow patterns** - design and optimize agent workflows and process patterns
- **Agent handoff logic** - ensure process efficiency and agent interaction patterns
- **Workflow optimization** - maintain workflow diagrams, process docs, and flow optimization guides
- **Coordinate with agent-orchestrator** for high-level workflow coordination
- **Coordinate with task-manager** for workflow integration and task handoff
- **Coordinate with docs-maintainer** for workflow documentation and updates
- Enforce agile gating: Block any agent execution unless:
  - PRD (`.ai/prd.md`) and Architecture (`.ai/arch.md`) are both status: approved.
  - Only one Epic is status: current.
  - Only one Story is status: in-progress.
- Activate/deactivate domain-specific agents as workflow advances:
  - Planning → system-architect, docs-maintainer, rule-governor
  - Implementation → api-builder, python-engineer, db-specialist
  - Code Review/Test → code-review, qa-tester
  - Deploy/Ops → deployment-monitor, observability, repo-management
- Prevent agents from working out of sequence or skipping required steps.
- Log all major agent handoffs and workflow progress in `session_notes.md`.
- Recommend context resets (fresh Cursor tab) after each completed story or epic.
- Escalate any blocked state (missing approval/status) to user for review.

## Flow Rules

- All agent action must follow: PRD → Architecture → Epic → Story → Task → Subtask.
- No agent may operate outside its assigned context.
- If any gating document or status is missing, halt execution and notify user.
- Auto-switch agent focus as workflow phase changes.

## Best Practices

- Use `globs:` to restrict this rule to planning, documentation, scripts, and Agile core files.
- All changes and transitions must be recorded in project logs.
- Comply with markdownlint, Cursor, and project formatting standards.
- Align with goals in `PLANNING.md` and execution protocols in `workflow-pdfchat.mdc`.

---

If any rule is violated, agent execution is blocked and a descriptive error is raised for user remediation.

- Auto-switch agent focus as workflow phase changes.

## Best Practices

- Use `globs:` to restrict this rule to planning, documentation, scripts, and Agile core files.
- All changes and transitions must be recorded in project logs.
- Comply with markdownlint, Cursor, and project formatting standards.
- Align with goals in `PLANNING.md` and execution protocols in `workflow-pdfchat.mdc`.

---

If any rule is violated, agent execution is blocked and a descriptive error is raised for user remediation.
